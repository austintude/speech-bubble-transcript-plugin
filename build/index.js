(()=>{"use strict";var e,t={443:()=>{const e=window.wp.element,t=window.wp.blocks,r=window.wp.blockEditor,a=window.wp.components,o=window.wp.i18n;(0,t.registerBlockType)("transcript-blocks/transcript-block",{apiVersion:2,title:"Transcript Block",description:"Add downloadable transcripts to your post.",category:"media",icon:"media-text",supports:{html:!1},attributes:{url:{type:"string",default:""},transcript:{type:"array",default:[]},speakers:{type:"array",default:[{name:"Speaker 1",color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#ffffff",avatarUrl:""}]}},edit:t=>{const{attributes:{url:l,transcript:n,speakers:s},setAttributes:c}=t,i=(0,r.useBlockProps)({className:"my-class-name"});return(0,e.createElement)("div",i,(0,e.createElement)(r.InspectorControls,null,(0,e.createElement)(a.PanelBody,{title:(0,o.__)("Speakers Settings","textdomain"),initialOpen:!0},s.map(((t,l)=>(0,e.createElement)("div",{key:l},(0,e.createElement)(a.TextControl,{label:(0,o.__)("Name","textdomain"),value:t.name,onChange:e=>c({speakers:s.map(((t,r)=>l===r?{...t,name:e}:t))})}),(0,e.createElement)(r.PanelColorSettings,{title:(0,o.__)("Color Settings","textdomain"),initialOpen:!1,colorSettings:[{value:t.color,onChange:e=>c({speakers:s.map(((t,r)=>l===r?{...t,color:e}:t))}),label:(0,o.__)("Background Color","textdomain")}]}),(0,e.createElement)(r.PanelColorSettings,{title:(0,o.__)("Text Color","textdomain"),initialOpen:!1,colorSettings:[{value:t.textColor,onChange:e=>c({speakers:s.map(((t,r)=>l===r?{...t,textColor:e}:t))}),label:(0,o.__)("Text Color","textdomain")}]}),(0,e.createElement)(r.PanelColorSettings,{title:(0,o.__)("Speech Bubble Color","textdomain"),initialOpen:!1,colorSettings:[{value:t.bubbleColor,onChange:e=>c({speakers:s.map(((t,r)=>l===r?{...t,bubbleColor:e}:t))}),label:(0,o.__)("Speech Bubble Color","textdomain")}]}),(0,e.createElement)(a.SelectControl,{label:(0,o.__)("Role","textdomain"),value:t.role,options:[{label:"Guest",value:"guest"},{label:"Host",value:"host"}],onChange:e=>c({speakers:s.map(((t,r)=>l===r?{...t,role:e}:t))})}),(0,e.createElement)("br",null),(0,e.createElement)("br",null),(0,e.createElement)(r.MediaUpload,{onSelect:e=>{c({speakers:s.map(((t,r)=>l===r?{...t,avatarUrl:e.url}:t))})},allowedTypes:["image"],render:r=>{let{open:l}=r;return(0,e.createElement)(a.Button,{onClick:l},t.avatarUrl?(0,o.__)("Replace Avatar","textdomain"):(0,o.__)("Upload Avatar","textdomain"))}}),t.avatarUrl&&(0,e.createElement)(a.Button,{isDestructive:!0,onClick:()=>c({speakers:s.map(((e,t)=>l===t?{...e,avatarUrl:""}:e))})},(0,o.__)("Remove Avatar","textdomain")),(0,e.createElement)("br",null),(0,e.createElement)("br",null),(0,e.createElement)(a.Button,{isDestructive:!0,onClick:()=>c({speakers:s.filter(((e,t)=>l!==t))})},(0,o.__)("Remove Speaker","textdomain"))))),(0,e.createElement)(a.Button,{variant:"primary",onClick:()=>c({speakers:[...s,{name:"Speaker "+(s.length+1),color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#777",avatarUrl:""}]})},(0,o.__)("Add Speaker","textdomain")))),(0,e.createElement)(r.MediaUpload,{onSelect:async e=>{c({url:e.url});try{const t=await fetch("/wp-json/transcript-blocks/v1/parse-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})});if(console.log("HTTP response status:",t.status),console.log("HTTP response text:",await t.clone().text()),!t.ok)throw new Error("HTTP error "+t.status);const r=await t.json();c({transcript:r})}catch(e){console.error("Error during transcript parsing:",e)}},allowedTypes:["text/plain"],render:t=>{let{open:r}=t;return(0,e.createElement)(a.Button,{onClick:r},(0,o.__)("Upload File","textdomain"))}}),n&&n.map(((t,r)=>{let{speaker:a,speech:o}=t;const l=s.find((e=>e.name===a));return(0,e.createElement)("div",{key:r,className:"transcript-block-wrapper "+(l&&"guest"===l.role?"guest":"host")},(0,e.createElement)("strong",{className:"transcript-block-speech-speaker"},a,":"),(0,e.createElement)("div",{className:"transcript-block-speech",style:{color:l?l.textColor:"#000000",backgroundColor:l?l.bubbleColor:"#ffffff"}},(0,e.createElement)("span",{className:"transcript-block-speech-text"},o)))})))},save:t=>{const{attributes:{url:a,transcript:l,speakers:n}}=t,s=r.useBlockProps.save();return(0,e.createElement)("div",s,a&&(0,e.createElement)("a",{href:a,download:!0},(0,o.__)("Download Transcript","textdomain")),l&&l.map(((t,r)=>{let{speaker:a,speech:l}=t;const s=n.find((e=>e.name===a));return(0,e.createElement)("div",{key:r,className:"transcript-block-wrapper "+(s&&"guest"===s.role?"guest":"host")},(0,e.createElement)("strong",{className:"transcript-block-speech-speaker"},a,":"),s.avatarUrl&&(0,e.createElement)("img",{src:s.avatarUrl,className:`transcript-block-avatar ${s.role}`,alt:a+(0,o.__)(" Avatar","textdomain"),style:{borderRadius:"50%",width:"40px",height:"40px"}}),(0,e.createElement)("div",{className:"transcript-block-speech",style:{color:s?s.textColor:"#000000",backgroundColor:s?s.bubbleColor:"#ffffff"}},(0,e.createElement)("span",{className:"transcript-block-speech-text"},l)))})))}})}},r={};function a(e){var o=r[e];if(void 0!==o)return o.exports;var l=r[e]={exports:{}};return t[e](l,l.exports,a),l.exports}a.m=t,e=[],a.O=(t,r,o,l)=>{if(!r){var n=1/0;for(p=0;p<e.length;p++){for(var[r,o,l]=e[p],s=!0,c=0;c<r.length;c++)(!1&l||n>=l)&&Object.keys(a.O).every((e=>a.O[e](r[c])))?r.splice(c--,1):(s=!1,l<n&&(n=l));if(s){e.splice(p--,1);var i=o();void 0!==i&&(t=i)}}return t}l=l||0;for(var p=e.length;p>0&&e[p-1][2]>l;p--)e[p]=e[p-1];e[p]=[r,o,l]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};a.O.j=t=>0===e[t];var t=(t,r)=>{var o,l,[n,s,c]=r,i=0;if(n.some((t=>0!==e[t]))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(c)var p=c(a)}for(t&&t(r);i<n.length;i++)l=n[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(p)},r=globalThis.webpackChunktranscripts_block=globalThis.webpackChunktranscripts_block||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=a.O(void 0,[431],(()=>a(443)));o=a.O(o)})();