(()=>{"use strict";var e,t={443:()=>{const e=window.wp.element,t=window.wp.blocks,r=window.wp.blockEditor,a=window.wp.components,l=window.wp.i18n;(0,t.registerBlockType)("transcript-blocks/transcript-block",{apiVersion:2,title:"Transcript Block",description:"Add downloadable transcripts to your post.",category:"media",icon:"media-text",supports:{html:!1},attributes:{url:{type:"string",default:""},transcript:{type:"array",default:[]},speakers:{type:"array",default:[{name:"Speaker 1",color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#ffffff",avatarUrl:""}]},editedSpeakerIndex:{type:"number",default:0},linkColor:{type:"string",default:"#0000ff"},linkHoverColor:{type:"string",default:"#ff0000"}},edit:t=>{const{attributes:{url:o,transcript:n,speakers:i,linkColor:s,linkHoverColor:c,editedSpeakerIndex:p},setAttributes:m}=t,d=(0,r.useBlockProps)({className:"my-class-name"});return(0,e.createElement)("div",d,(0,e.createElement)(r.InspectorControls,null,(0,e.createElement)(a.PanelBody,{title:(0,l.__)("Speakers Settings","textdomain"),initialOpen:!0},i.map(((t,o)=>(0,e.createElement)(a.PanelBody,{title:t.name,initialOpen:!1,key:o},(0,e.createElement)(a.Button,{variant:"secondar",onClick:()=>{m({editedSpeakerIndex:o})}},(0,l.__)("Edit Speaker","textdomain")),o===p&&(0,e.createElement)("div",null,(0,e.createElement)(a.TextControl,{label:(0,l.__)("Name","textdomain"),value:t.name,onChange:e=>m({speakers:i.map(((t,r)=>o===r?{...t,name:e}:t))})}),(0,e.createElement)(r.PanelColorSettings,{title:(0,l.__)("Speech Bubble Color","textdomain"),initialOpen:!1,colorSettings:[{value:t.bubbleColor,onChange:e=>m({speakers:i.map(((t,r)=>o===r?{...t,bubbleColor:e}:t))}),label:(0,l.__)("Speech Bubble Color","textdomain")}]}),(0,e.createElement)(r.PanelColorSettings,{title:(0,l.__)("Text Color","textdomain"),initialOpen:!1,colorSettings:[{value:t.textColor,onChange:e=>m({speakers:i.map(((t,r)=>o===r?{...t,textColor:e}:t))}),label:(0,l.__)("Text Color","textdomain")}]}),(0,e.createElement)(r.PanelColorSettings,{title:(0,l.__)("Link Color","textdomain"),initialOpen:!1,colorSettings:[{value:s,onChange:e=>m({linkColor:e}),label:(0,l.__)("Link Color","textdomain")}]}),(0,e.createElement)(r.PanelColorSettings,{title:(0,l.__)("Link Hover Color","textdomain"),initialOpen:!1,colorSettings:[{value:c,onChange:e=>m({linkHoverColor:e}),label:(0,l.__)("Link Hover Color","textdomain")}]}),(0,e.createElement)(a.SelectControl,{label:(0,l.__)("Role","textdomain"),value:t.role,options:[{label:"Guest",value:"guest"},{label:"Host",value:"host"}],onChange:e=>m({speakers:i.map(((t,r)=>o===r?{...t,role:e}:t))})}),(0,e.createElement)(r.MediaUpload,{onSelect:e=>{m({speakers:i.map(((t,r)=>o===r?{...t,avatarUrl:e.url}:t))})},allowedTypes:["image"],render:r=>{let{open:o}=r;return(0,e.createElement)(e.Fragment,null,t.avatarUrl&&(0,e.createElement)("img",{src:t.avatarUrl,alt:"Speaker Avatar",style:{maxWidth:"100px",maxHeight:"100px"}}),(0,e.createElement)("br",null),(0,e.createElement)(a.Button,{variant:"primary",onClick:o},t.avatarUrl?(0,l.__)("Replace Avatar","textdomain"):(0,l.__)("Upload Avatar","textdomain")))}}),t.avatarUrl&&(0,e.createElement)(a.Button,{isDestructive:!0,onClick:()=>m({speakers:i.map(((e,t)=>o===t?{...e,avatarUrl:""}:e))})},(0,l.__)("Remove Avatar","textdomain")),(0,e.createElement)("br",null),(0,e.createElement)("br",null),(0,e.createElement)(a.Button,{isDestructive:!0,onClick:()=>m({speakers:i.filter(((e,t)=>o!==t))})},(0,l.__)("Remove Speaker","textdomain")),(0,e.createElement)("br",null),(0,e.createElement)("br",null))))),(0,e.createElement)(a.Button,{variant:"primary",onClick:()=>m({speakers:[...i,{name:"Speaker "+(i.length+1),color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#777",avatarUrl:""}]})},(0,l.__)("Add Speaker","textdomain"))),(0,e.createElement)(a.PanelBody,{title:(0,l.__)("Transcript","textdomain"),initialOpen:!1},(0,e.createElement)(a.TextControl,{label:(0,l.__)("Transcript URL","textdomain"),value:o,onChange:e=>m({url:e})}))),(0,e.createElement)(r.MediaUpload,{onSelect:async e=>{m({url:e.url});try{const t=await fetch("/wp-json/transcript-blocks/v1/parse-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})});if(console.log("HTTP response status:",t.status),console.log("HTTP response text:",await t.clone().text()),!t.ok)throw new Error("HTTP error "+t.status);const r=await t.json();m({transcript:r})}catch(e){console.error("Error during transcript parsing:",e)}},allowedTypes:["text/plain"],render:t=>{let{open:r}=t;return(0,e.createElement)(a.Button,{onClick:r},(0,l.__)("Upload File","textdomain"))}}),n&&n.map(((t,a)=>{let{speaker:l,speech:o}=t,p=i.find((e=>e.name===l));return p||(p={name:l,color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#777",avatarUrl:""}),(0,e.createElement)("div",{key:a,className:"transcript-block-wrapper "+(p&&"guest"===p.role?"guest":"host")},(0,e.createElement)("strong",{className:"transcript-block-speech-speaker"},l,":"),(0,e.createElement)("div",{className:"transcript-block-speech",style:{color:p?p.textColor:"#000000",backgroundColor:p?p.bubbleColor:"#ffffff","--link-color":s,"--link-hover-color":c}},(0,e.createElement)(r.RichText,{tagName:"span",className:"transcript-block-speech-text",value:o,onChange:e=>m({transcript:n.map(((t,r)=>a===r?{...t,speech:e}:t))})})))})))},save:t=>{const{attributes:{url:a,transcript:o,speakers:n,linkColor:i,linkHoverColor:s}}=t,c=r.useBlockProps.save();return(0,e.createElement)("div",c,a&&(0,e.createElement)("a",{href:a,download:!0},(0,l.__)("Download Transcript","textdomain")),o&&o.map(((t,r)=>{let{speaker:a,speech:o}=t,c=n.find((e=>e.name===a));return c||(c={name:a,color:"#ffffff",role:"host",textColor:"#ffffff",bubbleColor:"#777",avatarUrl:""}),(0,e.createElement)("div",{key:r,className:"transcript-block-wrapper "+(c&&"guest"===c.role?"guest":"host")},(0,e.createElement)("strong",{className:"transcript-block-speech-speaker"},a,":"),c.avatarUrl&&(0,e.createElement)("img",{src:c.avatarUrl,className:`transcript-block-avatar ${c.role}`,alt:a+(0,l.__)(" Avatar","textdomain"),style:{borderRadius:"50%",width:"40px",height:"40px"}}),(0,e.createElement)("div",{className:"transcript-block-speech",style:{color:c?c.textColor:"#000000",backgroundColor:c?c.bubbleColor:"#ffffff","--link-color":i,"--link-hover-color":s}},(0,e.createElement)("span",{className:"transcript-block-speech-text",dangerouslySetInnerHTML:{__html:o}})))})))}})}},r={};function a(e){var l=r[e];if(void 0!==l)return l.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.m=t,e=[],a.O=(t,r,l,o)=>{if(!r){var n=1/0;for(p=0;p<e.length;p++){for(var[r,l,o]=e[p],i=!0,s=0;s<r.length;s++)(!1&o||n>=o)&&Object.keys(a.O).every((e=>a.O[e](r[s])))?r.splice(s--,1):(i=!1,o<n&&(n=o));if(i){e.splice(p--,1);var c=l();void 0!==c&&(t=c)}}return t}o=o||0;for(var p=e.length;p>0&&e[p-1][2]>o;p--)e[p]=e[p-1];e[p]=[r,l,o]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};a.O.j=t=>0===e[t];var t=(t,r)=>{var l,o,[n,i,s]=r,c=0;if(n.some((t=>0!==e[t]))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(s)var p=s(a)}for(t&&t(r);c<n.length;c++)o=n[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(p)},r=globalThis.webpackChunktranscripts_block=globalThis.webpackChunktranscripts_block||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var l=a.O(void 0,[431],(()=>a(443)));l=a.O(l)})();